-- =====================================
-- SECTION D: EMP_D, COMPANY_D, MANAGER_D
-- =====================================
CREATE TABLE EMP_D (
 EMP_NAME VARCHAR2(50),
 EMP_CITY VARCHAR2(50),
 SALARY NUMBER,
 COMPANY_NAME VARCHAR2(50),
 MANAGER_NAME VARCHAR2(50),
 STREET VARCHAR2(50)
);
CREATE TABLE COMPANY_D (
 COMPANY_NAME VARCHAR2(50),
 COMPANY_CITY VARCHAR2(50)
);
CREATE TABLE MANAGER_D (
 MANAGER_NAME VARCHAR2(50),
 STREET VARCHAR2(50),
 CITY VARCHAR2(50)
);
INSERT INTO EMP_D VALUES ('Tom', 'Chicago', 5000, 'First Bank Corporation', 'Jade', 'Lakeview');
INSERT INTO EMP_D VALUES ('Amy', 'New York', 4200, 'IBM', 'Ron', '5th Ave');
INSERT INTO EMP_D VALUES ('Rick', 'Chicago', 4700, 'First Bank Corporation', 'Jade', 'Lakeview');
INSERT INTO EMP_D VALUES ('Mia', 'San Francisco', 3900, 'Google', 'Zoe', 'Market St');
INSERT INTO EMP_D VALUES ('Leo', 'Chicago', 5100, 'First Bank Corporation', 'Jade', 'Lakeview');
INSERT INTO COMPANY_D VALUES ('First Bank Corporation', 'Chicago');
INSERT INTO COMPANY_D VALUES ('IBM', 'New York');
INSERT INTO COMPANY_D VALUES ('Google', 'San Francisco');
INSERT INTO MANAGER_D VALUES ('Jade', 'Lakeview', 'Chicago');
INSERT INTO MANAGER_D VALUES ('Ron', '5th Ave', 'New York');
INSERT INTO MANAGER_D VALUES ('Zoe', 'Market St', 'San Francisco');
-- Answer 1:
SELECT EMP_NAME FROM EMP_D WHERE COMPANY_NAME = 'First Bank Corporation';
-- Answer 2:
SELECT EMP_NAME FROM EMP_D E JOIN COMPANY_D C ON E.COMPANY_NAME =
C.COMPANY_NAME WHERE E.EMP_CITY = C.COMPANY_CITY;
-- Answer 3:
SELECT EMP_NAME FROM EMP_D E JOIN MANAGER_D M ON E.MANAGER_NAME =
M.MANAGER_NAME WHERE E.EMP_CITY = M.CITY AND E.STREET = M.STREET;
-- Answer 4:
SELECT EMP_NAME FROM EMP_D E WHERE SALARY > (SELECT AVG(SALARY) FROM EMP_D WHERE
COMPANY_NAME = E.COMPANY_NAME);
-- Answer 5:
SELECT COMPANY_NAME FROM (
 SELECT COMPANY_NAME, SUM(SALARY) AS PAYROLL FROM EMP_D GROUP BY COMPANY_NAME
ORDER BY PAYROLL DESC
) WHERE ROWNUM = 1;
