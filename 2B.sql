-- =====================================
-- SECTION B: EMP_B, COMPANY, MANAGER
-- =====================================
CREATE TABLE EMP_B (
 EMP_NAME VARCHAR2(50),
 EMP_CITY VARCHAR2(50),
 SALARY NUMBER,
 COMPANY_NAME VARCHAR2(50),
 MANAGER_NAME VARCHAR2(50),
 STREET VARCHAR2(50)
);
CREATE TABLE COMPANY (
 COMPANY_NAME VARCHAR2(50),
 COMPANY_CITY VARCHAR2(50)
);
CREATE TABLE MANAGER (
 MANAGER_NAME VARCHAR2(50),
 STREET VARCHAR2(50),
 CITY VARCHAR2(50)
);
INSERT INTO EMP_B VALUES ('John', 'New York', 4000, 'IBM', 'Mike', '5th Ave');
INSERT INTO EMP_B VALUES ('Sara', 'San Jose', 4500, 'Apple', 'Linda', 'Main St');
INSERT INTO EMP_B VALUES ('Ravi', 'Bangalore', 3000, 'IBM', 'Mike', 'MG Road');
INSERT INTO EMP_B VALUES ('Nina', 'New York', 4800, 'IBM', 'Mike', '5th Ave');
INSERT INTO EMP_B VALUES ('Alex', 'San Jose', 3500, 'Apple', 'Linda', 'Main St');
INSERT INTO COMPANY VALUES ('IBM', 'New York');
INSERT INTO COMPANY VALUES ('Apple', 'San Jose');
INSERT INTO COMPANY VALUES ('First Bank Corporation', 'Chicago');
INSERT INTO MANAGER VALUES ('Mike', '5th Ave', 'New York');
INSERT INTO MANAGER VALUES ('Linda', 'Main St', 'San Jose');
-- Answer 1:
SELECT EMP_NAME FROM EMP_B WHERE COMPANY_NAME = 'IBM';
-- Answer 2:
SELECT EMP_NAME FROM EMP_B E JOIN COMPANY C ON E.COMPANY_NAME = C.COMPANY_NAME
WHERE E.EMP_CITY = C.COMPANY_CITY;
-- Answer 3:
SELECT EMP_NAME FROM EMP_B E JOIN MANAGER M ON E.MANAGER_NAME =
M.MANAGER_NAME WHERE E.EMP_CITY = M.CITY AND E.STREET = M.STREET;
-- Answer 4:
SELECT EMP_NAME FROM EMP_B E WHERE SALARY > (SELECT AVG(SALARY) FROM EMP_B WHERE
COMPANY_NAME = E.COMPANY_NAME);
-- Answer 5:
SELECT COMPANY_NAME FROM (
 SELECT COMPANY_NAME, SUM(SALARY) AS PAYROLL FROM EMP_B GROUP BY COMPANY_NAME
ORDER BY PAYROLL ASC
) WHERE ROWNUM = 1;
